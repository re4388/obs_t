


 實際會用在 real word 上的 Lists and Sets


List
![[IMG-cs61b 4.4. Exceptions, Iterators, Object Methods-20241003104933855.png|725]]



Set
![[IMG-cs61b 4.4. Exceptions, Iterators, Object Methods-20241003104948792.png|664]]


我們自己弄一個 set 吧
![[IMG-cs61b 4.4. Exceptions, Iterators, Object Methods-20241003105002311.png|901]]

如果用 `x == items[i]` 這樣是比較這個 mem box 裡面的東西，這樣 就算 兩個都是 "cat", "cat" 比較，因為記憶體位置不同，會算不一樣
因此如果我們要比較的是 sematic 的比較，就是兩個 set 是否一樣，長度，裡面的 ele, 那我們要自己去實作
![[IMG-cs61b 4.4. Exceptions, Iterators, Object Methods-20241003105019898.png|809]]


![[IMG-cs61b 4.4. Exceptions, Iterators, Object Methods-20241003105020104.png|824]]


這邊用 泛型, type argument
定義的時候還沒確定 type
使用這個class 時，我們可以塞入不同的type
![[IMG-cs61b 4.4. Exceptions, Iterators, Object Methods-20241003105045786.png|544]]


# exception

這邊有null ptr exception 要處理
因為我們 add null
然後跑到 contain
x.equal, null 沒有 equal method -> crash

(extactly like JS undefined error)

![[IMG-cs61b 4.4. Exceptions, Iterators, Object Methods-20241003105111951.png|736]]


有幾種處理分法：
- throw error when they add null to the set
- 當使用的 method 看到 null, ignore -> make null safe method
- or catch it and reponse in another way
![[IMG-cs61b 4.4. Exceptions, Iterators, Object Methods-20241003105127891.png|761]]
![[CleanShot 2024-12-11 at 08.17.07.png|828]]

# Iterable


[[CS61B Data Structures and Algorithms|cs61b_index]]


左邊是右邊的 synax surger
你的 class 只要 impl 右邊的 Iterator 就可以使用左邊的 syntax
![[IMG-cs61b 4.4. Exceptions, Iterators, Object Methods-20241003105128053.png|714]]

根據 iterator 呼叫的方法，可以猜想他是如何實作的
- set 裡面要有一個 iterator method, 可以拿到 Iterator Obj
- this Iterator type, or seer obj, 有 hasNext and next method

![[IMG-cs61b 4.4. Exceptions, Iterators, Object Methods-20241003105137171.png|847]]


![[IMG-cs61b 4.4. Exceptions, Iterators, Object Methods-20241003105137270.png|751]]

![[IMG-cs61b 4.4. Exceptions, Iterators, Object Methods-20241003105145031.png|754]]


要使用 for-each iteration, 我們的 ArraySet 要 implement Iterable, Java 才會認得
![[IMG-cs61b 4.4. Exceptions, Iterators, Object Methods-20241003105152222.png|756]]


build in 的 Set extends Collection, Collection extend iterable
所以 Set 可以用 for syntax
![[IMG-cs61b 4.4. Exceptions, Iterators, Object Methods-20241003105152341.png|753]]
[link1](https://github.com/AdoptOpenJDK/openjdk-jdk11/blob/999dbd4192d0f819cb5224f26e9e7fa75ca6f289/src/java.base/share/classes/java/lang/Iterable.java)
[link2](https://github.com/AdoptOpenJDK/openjdk-jdk11/blob/999dbd4192d0f819cb5224f26e9e7fa75ca6f289/src/java.base/share/classes/java/util/Set.java)
[link3](https://github.com/AdoptOpenJDK/openjdk-jdk11/blob/999dbd4192d0f819cb5224f26e9e7fa75ca6f289/src/java.base/share/classes/java/util/Collection.java)




所以，為了可以用 for-loop syntax...
![[IMG-cs61b 4.4. Exceptions, Iterators, Object Methods-20241003105158052.png|816]]


- An iterator is to a bookmark as an iterable is to a book
	- An iterable is what you’re iterating through (the book)
	- An iterator is the actual machine doing the iterating
		- An iterator’s hasNext() tells you whether or not there are any pages left, and its next() method keeps track of where you are in the book
    

```java

import java.util.Iterator;
public class BookmarkIterator implements Iterator<String> {
	public BookmarkIterator(String book) {...} // constructor
	public boolean hasNext() {...} 
	public String next() { // returns a letter on each iteration}
}


String book = “ab”;
BookmarkIterator bIterator = new BookmarkIterator(book);
int spareTime = 1;
while (spareTime > 0) {
	if (bIterator.hasNext()) {	
	System.out.println(bIterator.next());
}
	spareTime--;
}

System.out.println(“I didn’t have time to read” 
 bIterator.next());


```



- If you want to use an enhanced for loop, you must make sure that you are looping through an iterable
- If you build your own iterable, make sure that it implements `Iterable<T>`, and that it defines an iterator() method



結論：

如果你有一個 class impl `Iterable<T>` interface
那這個 class 需要實作什麼?
`public Iterator<T> iterator()`


 如果你有一個 class impl  `Iterator<T>` interface
 那這個 class 需要實作什麼?
 `public boolean hasNext()`
 `public T next()`


Iterable 和 Iterator 的差異?
我們用 Iterable 來 support "enhanced loop"
我們用 iterator 來定義 客製化的 iterator




# `toString()`



![[IMG-cs61b 4.4. Exceptions, Iterators, Object Methods-20241003105158229.png|716]]
[println](https://github.com/AdoptOpenJDK/openjdk-jdk11/blob/f0ef2826d2116f4e0c0ed21f8d54fe9d0706504e/src/java.base/share/classes/java/lang/String.java)
[String.valueOf](https://github.com/AdoptOpenJDK/openjdk-jdk11/blob/f0ef2826d2116f4e0c0ed21f8d54fe9d0706504e/src/java.base/share/classes/java/lang/String.java)


printLn 當下就會呼叫 toString()
不然你只會看到 @arrayxxxxx 
就是只會印出記憶體位置
![[IMG-cs61b 4.4. Exceptions, Iterators, Object Methods-20241003105206374.png|737]]
[implementation of toString() in Object](https://github.com/AdoptOpenJDK/openjdk-jdk11/blob/999dbd4192d0f819cb5224f26e9e7fa75ca6f289/src/java.base/share/classes/java/lang/Object.java#L245)



實作 toString
直接用 string concate -> 每一次加入新的 string 就是建立一個新的 string
![[IMG-cs61b 4.4. Exceptions, Iterators, Object Methods-20241003105210255.png|768]]


![[IMG-cs61b 4.4. Exceptions, Iterators, Object Methods-20241003105210407.png|569]]



# ` ==, this, equals


 == is probably not what u want
 因為這是比較這個 array 的記憶體位置
![[IMG-cs61b 4.4. Exceptions, Iterators, Object Methods-20241003105214399.png|690]]



this in Java 會自動幫你加
![[IMG-cs61b 4.4. Exceptions, Iterators, Object Methods-20241003105214605.png|664]]



可是如果你有 name conflict, 那你就要加 this 了
![[IMG-cs61b 4.4. Exceptions, Iterators, Object Methods-20241003105217895.png|700]]


![[IMG-cs61b 4.4. Exceptions, Iterators, Object Methods-20241003105218044.png|695]]
[link](https://github.com/AdoptOpenJDK/openjdk-jdk11/blob/999dbd4192d0f819cb5224f26e9e7fa75ca6f289/src/java.base/share/classes/java/lang/Object.java#L157)

![[IMG-cs61b 4.4. Exceptions, Iterators, Object Methods-20241003105222427.png|747]]



`o instanceOf Dog uddaDog`: 
- check `o` 的 動態型別 是否為 `Dog`, if true -> 幫你把 `o` casting 為 `Dog` and assign `o` to `uddaDog`

![[IMG-cs61b 4.4. Exceptions, Iterators, Object Methods-20241003105222584.png|626]]


最後改為的版本
第一行是 for perf, 如果是自己就不用比較了
另外這邊是 set, 因此不需要 in order, 因此下面用 contains 確認而已
![[IMG-cs61b 4.4. Exceptions, Iterators, Object Methods-20241003105226391.png|624]]



![[IMG-cs61b 4.4. Exceptions, Iterators, Object Methods-20241003105226627.png|721]]


# summary
![[CleanShot 2024-12-11 at 09.00.58.png|847]]


# Extra bonus
![[IMG-cs61b 4.4. Exceptions, Iterators, Object Methods-20241003105229883.png]]


## 改用 join 來做, 更好懂
![[IMG-cs61b 4.4. Exceptions, Iterators, Object Methods-20241003105233997.png|506]]



## 建立 `ArraySet.of`
![[IMG-cs61b 4.4. Exceptions, Iterators, Object Methods-20241003105236845.png|505]]


然後就可以這樣用
![[CleanShot 2024-12-11 at 13.17.09.png]]