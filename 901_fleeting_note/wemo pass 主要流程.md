---
aliases:
  - wemo pass flow
---


[[wemo_pass_note]]



---


## [User App] 使用者 VIP 租車流程

![[IMG-wemo pass 主要流程-20241003104934089.png|850]]

## [User App] 使用者 開始訂閱 / 接續訂閱 VIP 流程

### Direct Pay

  ![[IMG-wemo pass 主要流程-20241003104948946.png]]



### WeMo Wallet
![[IMG-wemo pass 主要流程-20241003105011977.png]]
  
  


## [User App] 使用者設定自動續訂


- 方案還沒到期，應該要呼叫 patch 來調整自動續訂設定。方案到期，用 post
- User 必須是 VIP 身份且有效才可以設定續訂參數
    ![[IMG-wemo pass 主要流程-20241003105012133.png]]

  

  

## [User App] 開始訂月/續訂/更改續訂條件判斷與使用的API
![[IMG-wemo pass 主要流程-20241003105038884.png]]
  
  

## [Apollo] 客服調整使用者訂閱流程
![[IMG-wemo pass 主要流程-20241003105038995.png]]
  

## [Apollo] 客服取消 VIP 退款流程

  ![[IMG-wemo pass 主要流程-20241003105103397.png]]

**

# 騎乘費計算 Pseudo code
```md

是否為 VIP user?
+ True:
|   套用一般用戶費率
|   |  
|   是否有小時租方案？
|   + True:
|   |   騎乘時間 = 還車時間 - max((租車時間 + 3分鐘), 小時租截止)
|   |
|   - False:
|       騎乘時間 = 還車時間 - (租車時間 + 3分鐘)
|
|   是否超過起步價時間？(aka 起步價, 前六分鐘 $15)
|   + True:
|   |   訂單金額 = (起步價金額 + (騎乘時間(無條件進位為分) - 起步價時間) * 費率)
|   - False:
|       訂單金額 = 起步價金額
|   訂單金額 = 訂單金額 * 騎乘趟數折數
|      
|   抽獎結果是否中獎？ (luckyDraw)
|   + True:
|   |   訂單金額 = 調整中獎金額
|   - False:
|
|   是否有現金騎乘券？ (RebateVoucher)
|   + True:
|   |   訂單金額 -= 騎乘券金額
|   |   - False:29
|
|   訂單金額是否大於 10 元或有使用 VIP 騎乘券？
|   + True:
|   |   趟次累積 = True
|   - False
|       趟次累積 = False
|      
|   訂單金額 += 保險金額
|
-  False:
   套用使用者身份方案 (企業用戶/員工方案/一般用戶...) 費率
   
   是否有小時租方案？
   + True:
   |   騎乘時間 = 還車時間 - max(租車時間, 小時租截止)
   |
   - False:
       騎乘時間 = 還車時間 - 租車時間


   是否有月租方案？
   + True:
   |   騎乘時間 -= 月租剩餘時間
   |   套用月租費率
   |
   - False:


   是否超過起步價時間？
   + True:
   |   訂單金額 = (起步價金額 + (騎乘時間(無條件進位為分) - 起步價時間) * 費率)
   - False:
       訂單金額 = 起步價金額


   抽獎結果是否中獎？
   + True:
   |   訂單金額 = 調整中獎金額
   - False:
  
   是否有現金騎乘券？
   + True:
   |   訂單金額 -= 騎乘券金額
   - False:


   訂單金額 += 保險金額


```
  

  
  

# 退費計價 Pseudo code

```md

Case1: 使用者已訂閱，但未續訂
 剩餘月份殘值 = 訂單金額 - 已經過月份數 * 99
 當月份殘值 = 99


 是否有使用時間騎乘券？
   + True:
   |   當月份殘值 -= 當月已使用時間騎乘券數量 * 50
   - False:


 騎乘趟數是否大於 10 趟？
   + True:
   |   當月份殘值 = 0
   - False:


 可退款金額 = 剩餘月份殘值 + max(0, 當月份殘值)


Case2: 使用者已訂閱且已續訂，但續訂還沒有被消耗，只取消續訂部分
 可退款金額 = 已續訂未使用的訂單總金額


Case3: 使用者已訂閱且已續訂，但續訂還沒有被消耗，全部取消
 可退款金額 = Case1 + Case2


```

  
