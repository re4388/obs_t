


- pg 11 以前，新增欄位不要指定 default，會 table block
	- 一批一批慢慢加


- 使用  `lock timeouts`
	- 你的表可能會因為有 long query, 讓你的 alter table 等很久，進而讓更後面的等更久
```sql

-- 不要這樣
ALTER TABLE items ADD COLUMN last_update timestamptz;


-- 請這樣
SET lock_timeout TO '2s'
ALTER TABLE items ADD COLUMN last_update timestamptz;

如果 DDL 命令因为等待锁而阻塞查询超过 2 秒，该命令将会失败。这样做的缺点是 ALTER TABLE 可能不会成功，但可以稍后再试。

```













ref:
[解锁 7 大技巧，避免你的 Postgres 挂掉优秀的数据库仍然需要「正确」的使用姿势，但是人工检查总会疏漏。好在 B - 掘金](https://juejin.cn/post/7379512671618514996?searchId=202411101607557F478AEDA4D8EA3A1D7F)