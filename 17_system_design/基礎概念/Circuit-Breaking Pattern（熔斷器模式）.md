**Circuit-Breaking Pattern（熔斷器模式）** 是一種用於提高分佈式系統穩定性和可靠性的設計模式。它的主要目的是防止系統在面對故障或高延遲時進一步惡化，從而保護系統的其他部分不受影響。這種模式通常用於微服務架構中，特別是在服務之間的調用時。

### 熔斷器模式的工作原理

熔斷器模式的運作可以類比於電路中的熔斷器。當電路過載或出現故障時，熔斷器會自動切斷電源，以防止進一步的損壞。類似地，在軟體系統中，熔斷器模式會監控對某個服務的請求，並根據請求的成功率和延遲情況來決定是否繼續發送請求。

### 主要組件

1. **閉合狀態（Closed State）**：
    - 在正常情況下，熔斷器處於閉合狀態，所有請求都會被正常處理。
2. **打開狀態（Open State）**：
    - 當熔斷器檢測到連續的失敗（例如，服務不可用或超時），它會進入打開狀態。在這個狀態下，所有對該服務的請求都會被拒絕，並返回錯誤信息，這樣可以減少對故障服務的請求壓力。
3. **半開狀態（Half-Open State）**：
    - 在一段時間後，熔斷器會進入半開狀態，允許少量請求通過，以檢查服務是否恢復。如果這些請求成功，熔斷器會重新進入閉合狀態；如果失敗，則保持在打開狀態。

### 優點
- **提高系統穩定性**：通過防止故障服務的請求進一步影響系統的其他部分，熔斷器模式可以提高整體系統的穩定性。
- **快速失敗**：當服務不可用時，熔斷器可以快速返回錯誤，而不是等待超時，這樣可以提高用戶體驗。
- **恢復能力**：熔斷器模式允許系統在服務恢復後自動恢復正常操作。

### 使用場景

熔斷器模式特別適合用於以下場景：
- 微服務架構中，服務之間的調用。
- 需要與外部 API 進行交互的應用程序。
- 需要處理高延遲或不穩定服務的系統。

總之，熔斷器模式是一種有效的設計模式，可以幫助開發者構建更穩定和可靠的分佈式系統。