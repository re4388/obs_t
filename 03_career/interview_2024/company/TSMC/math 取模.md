在數學上，取模運算（`hash % len`）和位運算（`hash & (len - 1)`）在某些情況下是等價的，但有一些前提條件。

### 前提條件

1. **`len` 必須是 2 的冪次方**：這是使用位運算的關鍵條件。只有當 `len` 是 2 的冪次方時，`len - 1` 的二進制表示中所有的位都是 1，這樣才能保證 `hash & (len - 1)` 的結果等同於 `hash % len`。
    
    例如：
    
    - 如果 `len = 8`（即 `2^3`），則 `len - 1 = 7`（二進制為 `111`）。
    - 對於任何整數 `hash`，`hash & 7` 會返回 `hash % 8` 的結果。

### 為什麼這樣做？

- **性能**：位運算通常比取模運算更快，因為位運算是直接操作二進制位，而取模運算涉及到除法運算，這在計算上通常更慢。
- **哈希表的實現**：在哈希表的實現中，經常使用 `hash & (len - 1)` 來確保哈希值在數組的範圍內，特別是當數組的大小是 2 的冪次方時。

### 結論

- 當 `len` 是 2 的冪次方時，`hash % len` 和 `hash & (len - 1)` 是等價的，並且可以互換使用。
- 如果 `len` 不是 2 的冪次方，則這兩個運算的結果將不相同，因此在使用位運算時必須確保 `len` 符合這一條件。